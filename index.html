<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Tutor [V2]: Behaviour of Gases</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

    <style>
        :root {
            --primary-color: #0056b3;
            --secondary-color: #007bff;
            --background-color: #f4f7f9;
            --text-color: #333;
            --card-bg: #ffffff;
            --border-color: #dee2e6;
            --font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        body {
            font-family: var(--font-family);
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.7;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 960px;
            margin: auto;
        }
        header { text-align: center; margin-bottom: 2rem; }
        h1 { color: var(--primary-color); }
        .tabs-nav {
            display: flex;
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
            padding: 8px;
            margin-bottom: 1.5rem;
        }
        .nav-btn {
            flex: 1;
            padding: 12px 15px;
            border: none;
            background-color: transparent;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            color: #555;
            border-radius: 6px;
            transition: background-color 0.3s, color 0.3s;
            text-align: center;
        }
        .nav-btn:hover { background-color: #e9ecef; }
        .nav-btn.active {
            background-color: var(--primary-color);
            color: white;
            box-shadow: 0 2px 4px rgba(0, 86, 179, 0.3);
        }
        .content-section { display: none; }
        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .card {
            background: var(--card-bg);
            padding: 1.5rem 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
            margin-bottom: 1.5rem;
        }
        h2, h3 { color: var(--primary-color); border-bottom: 2px solid #eef; padding-bottom: 8px; margin-top: 0; }
        ul { padding-left: 20px; }
        .formula-box {
            background-color: #e9f5ff;
            border-left: 4px solid var(--secondary-color);
            padding: 15px; margin: 15px 0; border-radius: 4px; font-size: 1.1em;
        }
        /* AI Tutor Section Styles */
        #ai-tutor-content textarea, #ai-tutor-content select, #ai-tutor-content button {
            width: 100%; padding: 12px; margin-bottom: 12px; border-radius: 6px; border: 1px solid var(--border-color); font-size: 1rem;
        }
        #ai-tutor-content button { background-color: var(--secondary-color); color: white; border: none; cursor: pointer; font-weight: bold; }
        #ai-response-area { margin-top: 1rem; padding: 1rem; background-color: #f8f9fa; border-radius: 6px; min-height: 50px; border: 1px solid var(--border-color); white-space: pre-wrap; }
        .loader { border: 4px solid #f3f3f3; border-radius: 50%; border-top: 4px solid var(--secondary-color); width: 25px; height: 25px; animation: spin 1s linear infinite; display: none; margin: 15px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Behaviour of Gases</h1>
            <p>An Interactive AI-Powered Study Guide</p>
        </header>

        <nav class="tabs-nav">
            <button class="nav-btn active" onclick="showSection('concepts')">Concepts & Laws</button>
            <button class="nav-btn" onclick="showSection('formulas')">Formula Sheet</button>
            <button class="nav-btn" onclick="showSection('advanced')">Advanced Topics</button>
            <button class="nav-btn" onclick="showSection('ai-tutor')">AI Tutor</button>
        </nav>

        <main>
            <section id="concepts" class="content-section active">
                </section>

            <section id="formulas" class="content-section">
                <div class="card">
                    <h2>Formula Sheet</h2>
                    <p>A quick reference for all key equations in this chapter.</p>
                    <div id="formulas-content"></div>
                </div>
            </section>

            <section id="advanced" class="content-section">
                 </section>

            <section id="ai-tutor" class="content-section">
                <div id="ai-tutor-content" class="card">
                    <h2>Ask the AI Tutor</h2>
                    <p>Have a question? Select an AI model and ask anything about the behaviour of gases.</p>
                    <textarea id="user-question" rows="4" placeholder="e.g., What is the physical significance of the van der Waals constant 'a'?"></textarea>
                    <select id="model-selector">
                        <option value="gemini">Gemini (Google)</option>
                        <option value="gpt">GPT (OpenAI)</option>
                        <option value="claude">Claude (Anthropic)</option>
                    </select>
                    <button onclick="getAIResponse()">Submit Question</button>
                    <h4>AI Response:</h4>
                    <div id="ai-response-area">
                        <div class="loader" id="loader"></div>
                        <p id="response-text">Your answer will appear here...</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // ===================================================================================
        // JAVASCRIPT LOGIC AND EXTRACTED DATA
        // ===================================================================================

        // --- Placeholder for OCR/Text Data ---
        const extractedTextbookContent = {
            conceptsAndLaws: [
                {
                    title: "Properties of Gases",
                    content: `
                        <ul>
                            <li>Gases have neither a definite shape nor volume, taking the shape and volume of their container.</li>
                            <li>They are highly compressible due to large intermolecular spaces.</li>
                            <li>They exhibit high rates of diffusion (intermixing) and effusion (escaping through a small hole).</li>
                            <li>Key measurable properties are <strong>Mass (m)</strong>, <strong>Volume (V)</strong>, <strong>Pressure (P)</strong>, and <strong>Temperature (T)</strong>.</li>
                        </ul>
                    `
                },
                {
                    title: "Boyle's Law",
                    content: "At constant temperature, the volume of a given mass of gas is <strong>inversely proportional</strong> to its pressure. The P-V graph is a hyperbola called an isotherm.",
                    formula: "P_1V_1 = P_2V_2"
                },
                {
                    title: "Charles' Law",
                    content: "At constant pressure, the volume of a given mass of gas is <strong>directly proportional</strong> to its absolute temperature (in Kelvin).",
                    formula: "\\frac{V_1}{T_1} = \\frac{V_2}{T_2}"
                },
                {
                    title: "Gay-Lussac's Law",
                    content: "At constant volume, the pressure of a given mass of gas is <strong>directly proportional</strong> to its absolute temperature. The P-T graph is an isochore.",
                    formula: "\\frac{P_1}{T_1} = \\frac{P_2}{T_2}"
                },
                {
                    title: "Avogadro's Law",
                    content: "At constant temperature and pressure, equal volumes of all gases contain an <strong>equal number of moles</strong> (or molecules).",
                    formula: "\\frac{V_1}{n_1} = \\frac{V_2}{n_2}"
                },
                {
                    title: "Ideal Gas Equation",
                    content: "This equation combines the gas laws to relate all four variables for a hypothetical 'ideal gas'. 'R' is the universal gas constant.",
                    formula: "PV = nRT"
                },
                 {
                    title: "Graham's Law of Diffusion",
                    content: "At constant temperature and pressure, the rate of diffusion (r) of a gas is <strong>inversely proportional</strong> to the square root of its molar mass (M) or density (d).",
                    formula: "\\frac{r_1}{r_2} = \\sqrt{\\frac{M_2}{M_1}} = \\sqrt{\\frac{d_2}{d_1}}"
                },
                {
                    title: "Dalton's Law of Partial Pressures",
                    content: "The total pressure exerted by a mixture of non-reacting gases is equal to the <strong>sum of the partial pressures</strong> of the individual gases.",
                    formula: "P_{total} = P_A + P_B + P_C + ..."
                }
            ],
            formulas: [
                { name: "Boyle's Law", eq: "P_1V_1 = P_2V_2" },
                { name: "Charles' Law", eq: "\\frac{V_1}{T_1} = \\frac{V_2}{T_2}" },
                { name: "Gay-Lussac's Law", eq: "\\frac{P_1}{T_1} = \\frac{P_2}{T_2}" },
                { name: "Avogadro's Law", eq: "\\frac{V_1}{n_1} = \\frac{V_2}{n_2}" },
                { name: "Ideal Gas Equation", eq: "PV = nRT" },
                { name: "Combined Gas Law", eq: "\\frac{P_1V_1}{T_1} = \\frac{P_2V_2}{T_2}" },
                { name: "Density from Ideal Gas Law", eq: "d = \\frac{PM}{RT}" },
                { name: "Graham's Law", eq: "\\frac{r_1}{r_2} = \\sqrt{\\frac{M_2}{M_1}}" },
                { name: "Dalton's Law", eq: "P_{total} = \\sum P_i" },
                { name: "Partial Pressure & Mole Fraction", eq: "P_i = X_i \\cdot P_{total}" },
                { name: "Kinetic Energy of Gas", eq: "E_k = \\frac{3}{2} nRT" },
                { name: "RMS Velocity", eq: "u_{rms} = \\sqrt{\\frac{3RT}{M}}" },
                { name: "Average Velocity", eq: "u_{avg} = \\sqrt{\\frac{8RT}{\\pi M}}" },
                { name: "Most Probable Velocity", eq: "u_{mp} = \\sqrt{\\frac{2RT}{M}}" },
                { name: "Van der Waals Equation", eq: "\\left(P + \\frac{an^2}{V^2}\\right)(V - nb) = nRT" }
            ],
            advancedTopics: [
                {
                    title: "Kinetic Molecular Theory of Gases",
                    content: `
                        <p>This theory explains the behavior of ideal gases based on a set of postulates:</p>
                        <ul>
                            <li>Gases consist of tiny particles in constant, random, straight-line motion.</li>
                            <li>The volume of the gas particles themselves is negligible compared to the container volume.</li>
                            <li>There are no attractive or repulsive forces between gas particles.</li>
                            <li>Collisions between particles and with container walls are perfectly elastic (no energy is lost).</li>
                            <li>The average kinetic energy of the particles is directly proportional to the absolute temperature (in Kelvin).</li>
                        </ul>
                    `
                },
                {
                    title: "Molecular Velocities",
                    content: `
                        <p>Not all gas molecules move at the same speed. Their speeds are described by a distribution:</p>
                        <ul>
                            <li><strong>Most Probable Velocity ($$u_{mp}$$):</strong> The speed possessed by the maximum number of molecules.</li>
                            <li><strong>Average Velocity ($$u_{avg}$$):</strong> The arithmetic mean of the speeds of all molecules.</li>
                            <li><strong>Root Mean Square (RMS) Velocity ($$u_{rms}$$):</strong> The square root of the mean of the squares of the speeds. It is used to calculate kinetic energy.</li>
                        </ul>
                        <p>For any gas, the relationship is: $$u_{rms} > u_{avg} > u_{mp}$$</p>
                    `
                },
                {
                    title: "Real Gases & Deviation from Ideal Behavior",
                    content: `
                        <p>Real gases deviate from ideal behavior because the postulates of the Kinetic Molecular Theory are not perfectly true:</p>
                        <ol>
                            <li>Real gas molecules <strong>do have finite volume</strong>.</li>
                            <li>There <strong>are intermolecular attractive forces</strong> between real gas molecules.</li>
                        </ol>
                        <p>Deviations are most significant at <strong>high pressure</strong> and <strong>low temperature</strong>.</p>
                        <h4>The Van der Waals Equation</h4>
                        <p>This is a modified ideal gas equation that accounts for the behavior of real gases:</p>
                        <div class="formula-box">$$ \\left(P + \\frac{an^2}{V^2}\\right)(V - nb) = nRT $$</div>
                        <ul>
                            <li>The '<strong>a</strong>' term corrects for <strong>intermolecular forces</strong> (the pressure correction).</li>
                            <li>The '<strong>b</strong>' term corrects for the <strong>volume of gas molecules</strong> (the volume correction).</li>
                        </ul>
                    `
                }
            ]
        };

        // --- Function to switch between tabs ---
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            // Deactivate all nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show the target section and activate its button
            document.getElementById(sectionId).classList.add('active');
            document.querySelector(`.nav-btn[onclick="showSection('${sectionId}')"]`).classList.add('active');
        }
        
        // --- Function to render content into the tabs ---
        function renderContent() {
            const conceptsArea = document.getElementById('concepts');
            const formulasArea = document.getElementById('formulas-content');
            const advancedArea = document.getElementById('advanced');

            // Render Concepts & Laws
            let conceptsHtml = '';
            extractedTextbookContent.conceptsAndLaws.forEach(item => {
                conceptsHtml += `<div class="card"><h2>${item.title}</h2><p>${item.content}</p>`;
                if (item.formula) {
                    conceptsHtml += `<div class="formula-box">$$ ${item.formula} $$</div>`;
                }
                conceptsHtml += `</div>`;
            });
            conceptsArea.innerHTML = conceptsHtml;

            // Render Formulas
            let formulasHtml = '';
            extractedTextbookContent.formulas.forEach(item => {
                formulasHtml += `<h3>${item.name}</h3><div class="formula-box">$$ ${item.eq} $$</div>`;
            });
            formulasArea.innerHTML = formulasHtml;

            // Render Advanced Topics
            let advancedHtml = '';
            extractedTextbookContent.advancedTopics.forEach(item => {
                advancedHtml += `<div class="card"><h2>${item.title}</h2>${item.content}</div>`;
            });
            advancedArea.innerHTML = advancedHtml;

            // Re-render math equations after dynamic insertion
            renderMathInElement(document.body);
        }

        // --- AI Model Integration and Logic ---
        async function getAIResponse() {
            const question = document.getElementById('user-question').value;
            const selectedModel = document.getElementById('model-selector').value;
            const responseArea = document.getElementById('response-text');
            const loader = document.getElementById('loader');

            if (!question.trim()) {
                responseArea.textContent = "Please enter a question.";
                return;
            }

            loader.style.display = 'block';
            responseArea.textContent = '';
            
            // --- Placeholder for API Keys ---
            const API_KEYS = {
                gemini: "YOUR_GEMINI_API_KEY_HERE",
                gpt: "YOUR_OPENAI_API_KEY_HERE",
                claude: "YOUR_ANTHROPIC_API_KEY_HERE"
            };
            
            // Create a comprehensive context from all textbook data
            const sourceContext = JSON.stringify(extractedTextbookContent);
            const prompt = `Based ONLY on the following textbook context about the 'Behaviour of Gases', answer the user's question. If the answer is not in the context, state that. Context: ${sourceContext}. User Question: "${question}"`;

            console.log(`Simulating API call to ${selectedModel}...`);
            setTimeout(() => {
                let simulatedResponse = "";
                // This is a simulated response. In a real application, you would make an API call.
                 if (question.toLowerCase().includes("van der waals") && question.toLowerCase().includes("'a'")) {
                    simulatedResponse = `(Simulated ${selectedModel} Response) Based on the provided context, the Van der Waals constant 'a' is a pressure correction term that accounts for the <strong>intermolecular attractive forces</strong> between real gas molecules. A higher value of 'a' indicates stronger attraction between molecules.`;
                } else {
                    simulatedResponse = `(Simulated ${selectedModel} Response) Thank you for your question about "${question}". According to the provided text, [relevant information would be extracted and summarized here].`;
                }
                
                loader.style.display = 'none';
                responseArea.innerHTML = simulatedResponse; // Use innerHTML to render bold tags
                renderMathInElement(document.getElementById('ai-response-area'));
            }, 1500);
        }

        // --- Initializer ---
        document.addEventListener('DOMContentLoaded', () => {
            renderContent();
        });
    </script>

</body>
</html>               }
                    ]
                },
                {
                    title: "The Ideal Gas Equation",
                    introduction: "An ideal gas is a hypothetical gas that obeys all gas laws under all conditions. The Ideal Gas Equation combines Boyle's, Charles', and Avogadro's laws.",
                    sections: [
                        {
                            title: "Equation and Constants",
                            content: "The equation relates all four measurable properties of a gas. 'R' is the universal gas constant.",
                            formulas: [
                                "PV = nRT",
                                "\\frac{P_1V_1}{T_1} = \\frac{P_2V_2}{T_2} \\quad (\\text{Combined Gas Law})",
                                "d = \\frac{PM}{RT} \\quad (\\text{Density relationship})"
                            ]
                        }
                    ]
                }
            ]
        };

        // --- Function to render the extracted content onto the page ---
        function renderContent() {
            const contentArea = document.getElementById('textbook-content');
            let html = '';
            extractedTextbookContent.chapters.forEach(chapter => {
                html += `<div class="chapter">`;
                html += `<h2>${chapter.title}</h2>`;
                html += `<p>${chapter.introduction}</p>`;
                chapter.sections.forEach(section => {
                    html += `<h3>${section.title}</h3>`;
                    html += section.content;
                    if (section.formulas.length > 0) {
                        section.formulas.forEach(formula => {
                            // Enclose LaTeX in delimiters for KaTeX
                            html += `<div class="formula-box">$$${formula}$$</div>`;
                        });
                    }
                });
                html += `</div>`;
            });
            contentArea.innerHTML = html;
            // Re-render math equations after dynamic content insertion
            renderMathInElement(document.body);
        }

        // --- AI Model Integration Hooks and Logic ---
        async function getAIResponse() {
            const question = document.getElementById('user-question').value;
            const selectedModel = document.getElementById('model-selector').value;
            const responseArea = document.getElementById('response-text');
            const loader = document.getElementById('loader');

            if (!question.trim()) {
                responseArea.textContent = "Please enter a question.";
                return;
            }

            // Show loader and clear previous response
            loader.style.display = 'block';
            responseArea.textContent = '';

            // --- Placeholder for Model API Keys ---
            // IMPORTANT: Replace these with your actual API keys.
            // In a real application, these should be stored securely on a backend server.
            const API_KEYS = {
                gemini: "YOUR_GEMINI_API_KEY_HERE",
                gpt: "YOUR_OPENAI_API_KEY_HERE",
                claude: "YOUR_ANTHROPIC_API_KEY_HERE"
            };

            // Create a concise context from the textbook data to send to the AI
            // This makes the AI "source-aware"
            const sourceContext = JSON.stringify(extractedTextbookContent);
            const prompt = `
                Based ONLY on the following textbook context about the 'Behaviour of Gases', please answer the user's question.
                If the answer cannot be found in the context, state that clearly.

                --- TEXTBOOK CONTEXT ---
                ${sourceContext}
                --- END OF CONTEXT ---

                USER QUESTION: "${question}"
            `;

            // --- SIMULATED API CALL LOGIC ---
            // This section demonstrates how you would structure the API call.
            // The `setTimeout` simulates network latency.
            console.log(`Simulating API call to ${selectedModel}...`);
            console.log("Sending Prompt:", prompt);

            setTimeout(() => {
                let simulatedResponse = "";
                switch (selectedModel) {
                    case "gemini":
                        simulatedResponse = `(Simulated Gemini Response) Boyle's Law states that for a fixed amount of gas at constant temperature, the volume is inversely proportional to the pressure. This means if you increase the pressure, the volume decreases. The formula is $P_1V_1 = P_2V_2$.`;
                        break;
                    case "gpt":
                        simulatedResponse = `(Simulated GPT Response) According to the provided text, Boyle's Law establishes an inverse relationship between pressure and volume when the temperature is kept constant. The mathematical expression for this law is $P_1V_1 = P_2V_2$.`;
                        break;
                    case "claude":
                        simulatedResponse = `(Simulated Claude Response) Based on the context, Boyle's Law describes how a gas's volume changes with pressure if the temperature doesn't change. They are inversely proportional, meaning as one goes up, the other goes down. This is represented by the equation $PV = K$.`;
                        break;
                }
                
                // Hide loader and display response
                loader.style.display = 'none';
                responseArea.textContent = simulatedResponse;

                // Re-render math in the AI response area
                renderMathInElement(document.getElementById('ai-response-area'));

            }, 1500); // Simulate 1.5 second delay

            /*
            // --- REAL API CALL PSEUDOCODE (Example for a generic fetch API) ---
            
            try {
                const response = await fetch('YOUR_AI_MODEL_API_ENDPOINT', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEYS[selectedModel]}`
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        max_tokens: 250
                    })
                });

                if (!response.ok) {
                    throw new Error(`API request failed with status ${response.status}`);
                }

                const data = await response.json();
                const answer = data.choices[0].text; // Adjust based on actual API response structure
                
                loader.style.display = 'none';
                responseArea.textContent = answer;
                renderMathInElement(document.getElementById('ai-response-area'));

            } catch (error) {
                loader.style.display = 'none';
                responseArea.textContent = `Error: Could not fetch response. ${error.message}`;
                console.error("API Call Error:", error);
            }
            */
        }

        // --- Initializer ---
        // This function runs when the page loads to populate the content.
        document.addEventListener('DOMContentLoaded', () => {
            renderContent();
        });
    </script>
</body>
</html>
